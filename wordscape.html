<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wordscape - Level 1</title>
<style>
  body {
    background: #f3f6ff;
    font-family: 'Poppins', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
  }
  h1 { margin-bottom: 10px; }
  #game {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  #letters {
    position: relative;
    width: 220px;
    height: 220px;
    border-radius: 50%;
  }
  .letter {
    position: absolute;
    width: 70px;
    height: 70px;
    background: white;
    border-radius: 50%;
    border: 3px solid #667;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
    transition: background 0.2s, color 0.2s;
  }
  .letter.active {
    background: #4a7cff;
    color: white;
  }
  #word-list {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    gap: 5px;
  }
  .word {
    font-size: 22px;
    letter-spacing: 5px;
  }
  #shuffle {
    margin-top: 25px;
    padding: 8px 16px;
    background: #4a7cff;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
  }
  #message {
    font-size: 28px;
    margin-top: 20px;
    color: #1d8b1d;
    display: none;
  }
  canvas {
    position: absolute;
    top: 0; left: 0;
    pointer-events: none;
  }
</style>
</head>
<body>
<h1>Wordscape - Level 1</h1>
<div id="game">
  <div id="letters"></div>
  <canvas id="lineCanvas" width="220" height="220"></canvas>
  <button id="shuffle">ðŸ”€ Shuffle</button>
  <div id="word-list"></div>
  <div id="message">Level Complete!</div>
</div>

<script>
const words = ["WORD", "ROW", "DO", "OR"];
let foundWords = new Set();
let letters = ["W", "O", "R", "D"];
const letterPositions = [
  [110, 10],
  [210, 110],
  [110, 210],
  [10, 110]
];

const container = document.getElementById("letters");
const canvas = document.getElementById("lineCanvas");
const ctx = canvas.getContext("2d");
const wordList = document.getElementById("word-list");
const message = document.getElementById("message");

letters.forEach((l, i) => {
  const div = document.createElement("div");
  div.className = "letter";
  div.textContent = l;
  div.style.left = (letterPositions[i][0]-35) + "px";
  div.style.top = (letterPositions[i][1]-35) + "px";
  container.appendChild(div);
});

let path = [];
let drawing = false;

function drawLine() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if (path.length < 2) return;
  ctx.beginPath();
  ctx.moveTo(path[0][0], path[0][1]);
  for (let i=1; i<path.length; i++) ctx.lineTo(path[i][0], path[i][1]);
  ctx.lineWidth = 6;
  ctx.strokeStyle = "rgba(0, 128, 255, 0.8)";
  ctx.shadowBlur = 12;
  ctx.shadowColor = "deepskyblue";
  ctx.stroke();
}

function checkWord(word) {
  if (words.includes(word) && !foundWords.has(word)) {
    foundWords.add(word);
    const el = document.createElement("div");
    el.className = "word";
    el.textContent = word;
    wordList.appendChild(el);
  }
  if (foundWords.size === words.length) {
    message.style.display = "block";
  }
}

container.addEventListener("mousedown", e => {
  if (e.target.classList.contains("letter")) {
    drawing = true;
    e.target.classList.add("active");
    path = [[e.target.offsetLeft+35, e.target.offsetTop+35]];
  }
});

container.addEventListener("mousemove", e => {
  if (!drawing) return;
  const target = e.target;
  if (target.classList.contains("letter") && !target.classList.contains("active")) {
    target.classList.add("active");
    path.push([target.offsetLeft+35, target.offsetTop+35]);
  }
  drawLine();
});

document.addEventListener("mouseup", () => {
  if (drawing) {
    const selected = Array.from(document.querySelectorAll(".letter.active"))
      .map(l => l.textContent)
      .join("");
    checkWord(selected);
    document.querySelectorAll(".letter").forEach(l => l.classList.remove("active"));
    path = [];
    ctx.clearRect(0,0,canvas.width,canvas.height);
  }
  drawing = false;
});

document.getElementById("shuffle").onclick = () => {
  letters.sort(() => Math.random() - 0.5);
  document.querySelectorAll(".letter").forEach((l, i) => {
    l.textContent = letters[i];
  });
};
</script>
</body>
</html>
